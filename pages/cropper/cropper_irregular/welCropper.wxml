<template name="welCropper">
	<scroll-view class="cropper_main_container {{cropperData.hidden?'hidden':''}}">
		<view class="cropper_container"
			style="width:{{cropperData.W}}px; height:{{cropperData.H}}px; top:{{cropperData.TOP}}px">
			<canvas class="original_canvas" canvas-id="originalCanvas"
				style="width:{{cropperChangableData.originalSize.width}}px;height:{{cropperChangableData.originalSize.height}}px;"></canvas>
			<image src='{{cropperData.imageInfo.path}}' class='scale-image cropper_canvas_container_item' mode='aspectFill' bindload="finishLoad"
				style="left:{{cropperChangableData.previewImageInfo.x}}px; top:{{cropperChangableData.previewImageInfo.y}}px; width:{{cropperChangableData.previewImageInfo.w}}px; height:{{cropperChangableData.previewImageInfo.h}}px; transform:rotate({{cropperChangableData.rotateDegree}}deg);">
			</image>
			<view class='cropper_canvas_container' 	style="width:{{cropperChangableData.scaleSize.width}}px;height:{{cropperChangableData.scaleSize.height}}px;">
				<canvas class="move_canvas cropper_canvas_container_item" canvas-id="moveCanvas"></canvas>
				<block wx:if="{{cropperData.drawSign}}">
					<movable-area class="cropper_movable_area_container" 
						style="width:{{cropperChangableData.scaleSize.width}}px;height:{{cropperChangableData.scaleSize.height}}px;">
						<block wx:if="{{cropperMovableItems}}">
							<block wx:for="{{cropperMovableItems}}" wx:key="moveItem">
								<movable-view class="move_item"
									style="width:{{cropperData.itemLength}}px; height:{{cropperData.itemLength}}px;" direction="all"
									x="{{item.x-cropperData.itemLength/2}}" y="{{item.y-cropperData.itemLength/2}}"
									bindtouchmove="moveEvent" bindtouchend="endEvent" data-key="{{index}}"></movable-view>
							</block>
						</block>
						<!-- all -->
						<movable-view class="move_item_outer"
							style="width:{{cropperMovableItems.topright.x-cropperMovableItems.topleft.x-26}}px; height:{{cropperMovableItems.bottomleft.y-cropperMovableItems.topleft.y-26}}px;"
							direction="all" x="{{cropperMovableItems.topleft.x+13}}" y="{{cropperMovableItems.topleft.y+13}}"
							bindtouchstart="startEvent" bindtouchmove="moveEvent" bindtouchend="endEvent" data-key="all">
						</movable-view>
						<!-- up,right.bottom,left -->
						<movable-view class="move_item_outer"
							style="width:{{cropperMovableItems.topright.x-cropperMovableItems.topleft.x-26}}px; height:12px;"
							direction="all" x="{{cropperMovableItems.topleft.x+13}}" y="{{cropperMovableItems.topleft.y-6}}"
							bindtouchmove="moveEvent" bindtouchend="endEvent" data-key="up"></movable-view>
						<movable-view class="move_item_outer"
							style="width:12px; height:{{cropperMovableItems.bottomright.y-cropperMovableItems.topright.y-26}}px;"
							direction="all" x="{{cropperMovableItems.topright.x-6}}" y="{{cropperMovableItems.topright.y+13}}"
							bindtouchmove="moveEvent" bindtouchend="endEvent" data-key="right"></movable-view>
						<movable-view class="move_item_outer"
							style="width:{{cropperMovableItems.bottomright.x-cropperMovableItems.bottomleft.x-26}}px; height:12px;"
							direction="all" x="{{cropperMovableItems.bottomleft.x+13}}" y="{{cropperMovableItems.bottomleft.y-6}}"
							bindtouchmove="moveEvent" bindtouchend="endEvent" data-key="bottom"></movable-view>
						<movable-view class="move_item_outer"
							style="width:12px; height:{{cropperMovableItems.bottomleft.y-cropperMovableItems.topleft.y-26}}px;"
							direction="all" x="{{cropperMovableItems.topleft.x-6}}" y="{{cropperMovableItems.topleft.y+13}}"
							bindtouchmove="moveEvent" bindtouchend="endEvent" data-key="left"></movable-view>
					</movable-area>
				</block>
				<block wx:else>
					<movable-area class="cropper_movable_area_container"
						style="width:{{cropperChangableData.scaleSize.width}}px;height:{{cropperChangableData.scaleSize.height}}px;">
						<block wx:if="{{cropperMovableItems}}">
							<block wx:for="{{cropperMovableItems}}" wx:key="moveItem">
								<movable-view class="move_item"
									style="width:{{cropperData.itemLength}}px; height:{{cropperData.itemLength}}px;" direction="all"
									x="{{item.x-cropperData.itemLength/2}}" y="{{item.y-cropperData.itemLength/2}}"
									bindtouchmove="moveEvent" bindtouchend="endEvent" data-key="{{index}}"></movable-view>
							</block>
						</block>
					</movable-area>
				</block>
			</view>
		</view>
		<view class="notify" wx:if="{{cropperData.drawSign}}">
			<image src="/images/edit-tip.png" />
			<view wx:if="{{cropperData.from==='photoAnswer'}}">每次只选一道题，更容易搜到答案</view>
			<view wx:else>请旋转题目至正确方向，并调整方框裁剪</view>
		</view>
		<!-- <view class="bottom_confirm">
        <view>
            <image src="/images/error_finish.png" bindtap="rotateImage" mode="widthFix"></image>
            <image src="/images/error_finish.png" bindtap="{{cropperChangableData.canCrop?'cropImage':''}}" mode="widthFix"></image>
            </view>
        </view> -->
		<view class="cover" wx:if="{{cropperData.from!='pic2doc'}}">
			<image class="small-icon" src="/images/crop_rotate.png" bindtap="rotateImage" />
			<image src="/images/error_finish.png" class="button-camera" id="camera"
				bindtap="{{cropperChangableData.canCrop?'cropImage':''}}" />
			<view wx:if="{{cropperData.from==='photoAnswer'}}" bindtap="rePhoto">重拍</view>
			<image wx:else class="small-icon" src="/images/crop_cancel.png" bindtap="cancel" />
		</view>
	</scroll-view>
</template>